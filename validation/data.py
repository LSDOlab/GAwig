import numpy as np
import matplotlib.pyplot as plt


# 61x14 wing
num_props = 8
num_spanwise_vlm = 61
num_span = int((num_spanwise_vlm - 1)/2)
rpos = np.array([87,67,47,9])/102
xpos = np.linspace(0,num_span,num_span)
norm_xpos = xpos/max(xpos)

no_prop_no_flap = np.array([5267.64042836, 5262.70766718, 5256.49847857, 5248.38781925, 5237.79848535,
 5224.4126759,  5207.07360678, 5036.00539725, 4975.84084334, 4933.74883613,
 4845.14285341, 4754.62381745, 4661.56742542, 4566.06223244, 4468.9118944,
 4369.98561261, 4268.13971758, 4163.03434723, 4054.73773873, 3942.42690487,
 3824.79616614, 3699.90766845, 3566.25949804, 3420.73992822, 3258.48031665,
 3072.09224612, 2850.23750527, 2572.30213061, 2196.15385413, 1375.73934355])

two_prop_no_flap = np.array([5424.75834234, 5420.22830101, 5414.86559197, 5408.03465651, 5399.2360806,
 5388.1303365,  5373.43569542, 5200.93313748, 5153.52796736, 5113.80123655,
 5032.040156,   4949.52593197, 4866.32374511, 4783.1591171,  4701.38591816,
 4621.91083139, 4545.2726784,  4473.38756638, 4409.41580084, 4358.04123686,
 4329.67935648, 4355.81608357, 4649.63948435, 7502.15376115, 6073.70543428,
 3955.36223908, 2430.76714766, 3134.84548749, 2010.52982614, 1291.13781483])

four_prop_no_flap = np.array([5457.19825377, 5453.71522325, 5450.50642506, 5447.0611898,  5443.06979925,
 5438.47521361, 5432.3452397,  5268.32361889, 5236.55474327, 5212.59075977,
 5152.73613049, 5099.01821582, 5054.17222016, 5024.25785333, 5019.68528947,
 5066.97664049, 5319.10472599, 7844.00890466, 7156.62222191, 4752.18109221,
 2036.012887,   4287.61995924, 4005.70512455, 7052.9877124,  5800.2916383,
 3792.04793045, 2327.40592213, 3068.0527452,  1969.1958021,  1271.83704208])

six_prop_no_flap = np.array([5486.68313419, 5484.93941104, 5485.38800114, 5487.88201566, 5492.73800206,
 5500.95306371, 5513.05327151, 5369.64470858, 5377.72460347, 5412.7223162,
 5529.32734247, 7237.7788865,  7310.26979373, 5050.18650615, 2455.02642981,
 3694.51289401, 4307.05073433, 7198.47622053, 6612.70369949, 4141.509704,
 1706.98483182, 4060.97260385, 3856.94927482, 6936.85316942, 5718.87926435,
 3733.86696063, 2283.96381344, 3037.6856331,  1948.68128498, 1261.32751857])

eight_prop_no_flap = np.array([8012.55742172, 8162.19906047, 5250.73431122, 3853.23469303, 6212.5833316,
 4750.12898456, 4934.6477741,  4980.88304105, 5101.99037501, 5210.97944604,
 5379.44854499, 7122.76678052, 7213.75513341, 4981.18088533, 2398.249938,
 3647.27693714, 4276.01960521, 7172.91772307, 6596.21287891, 4141.99263112,
 1699.94647693, 4052.23696818, 3850.2333265,  6929.66581165, 5713.15781996,
 3728.85152872, 2279.57177298, 3034.21506412, 1946.45774104, 1260.10762523])

no_prop_flap = np.array([20716.68970346, 20706.24897668, 20689.58350222, 20664.59668529,
 20631.28372777, 20587.77421866, 20531.41920055, 19719.63637291,
 19859.79140467, 19519.35405995, 19185.74036064, 18843.51594127,
 18494.69071966, 18138.8080716,  17773.00142705, 17397.78074963,
 17012.1113532,  16612.58317757, 16196.06608005, 15760.03148934,
 15299.56538969, 14808.38582835, 14277.11947134, 13691.732647,
 13034.48371651, 12278.07377663, 11376.74973437, 10249.74221995,
  8728.0873019,   5371.48790018])

two_prop_flap = np.array([20735.58166588, 20725.67456897, 20710.0869376,  20686.76669112,
 20655.77350724, 20615.32356332, 20562.86689539, 19754.60260369,
 19900.63090895, 19566.21040041, 19240.74778485, 18908.77894306,
 18572.89665615, 18233.4942378,  17888.84212681, 17541.03993327,
 17191.33898899, 16839.76188242, 16488.46603569, 16143.76006794,
 15818.71915208, 15555.95973094, 15670.63573444, 19921.08888493,
 17660.12999553, 14472.77128972, 13185.94667568, 12651.55491153,
  8784.11368335,  5336.85360767])

four_prop_flap = np.array([20774.59194219, 20766.25141657, 20753.89030223, 20735.64735486,
 20711.8773042,  20681.21977975, 20641.65319808, 19846.03080184,
 20011.51443454, 19699.83793403, 19405.876492,   19115.70410288,
 18835.92754172, 18573.99979406, 18339.65178526, 18161.86420212,
 18233.56180585, 21745.02626117, 21237.65300568, 17533.6170477,
 15451.73522762, 17542.86690384, 15355.38955353, 19752.39993542,
 17485.52233789, 14360.49983189, 13131.41161162, 12603.41991917,
  8750.85626077,  5321.36133806])

six_prop_flap = np.array([20803.93949206, 20798.00392815, 20790.66666998, 20780.51047713,
 20768.57083907, 20754.45268384, 20736.93199078, 19957.58144729,
 20135.36789698, 19837.42284232, 19602.36619064, 21131.8990645,
 22866.05445038, 18921.99106775, 16663.83946664, 19105.3121276,
 17402.79999699, 21305.10644414, 20797.23957704, 17242.06364193,
 15267.84089364, 17383.58467787, 15231.29318836, 19652.08020622,
 17408.98570326, 14302.61211936, 13087.9482904,  12569.68177525,
  8727.09772287,  5308.75517385])

eight_prop_flap = np.array([23923.75854092, 25092.4980526,  21094.50090074, 20780.61319989,
 24221.94360761, 19831.03302987, 20085.64298943, 19554.3936365,
 19876.6852568,  19652.7791395,  19464.83634106, 21021.24378812,
 22777.41938317, 18854.47588135, 16609.63636891, 19060.58755048,
 17366.85341735, 21275.13212868, 20774.39415114, 17223.61746469,
 15253.95896244, 17370.8259374,  15220.5045418,  19643.01178828,
 17401.74414183, 14296.69107055, 13083.92843521, 12565.46672346,
  8724.06836369,  5306.92730227])






fig = plt.figure(figsize=(8,6))



plt.semilogy(norm_xpos, no_prop_no_flap, linestyle='dashed', linewidth=2, color='black')
plt.semilogy(norm_xpos, two_prop_no_flap, linewidth=2, color='darkorange', alpha=0.5)
plt.semilogy(norm_xpos, four_prop_no_flap, linewidth=2, color='blue', alpha=0.5)
plt.semilogy(norm_xpos, six_prop_no_flap, linewidth=2, color='blueviolet', alpha=0.5)
plt.semilogy(norm_xpos, eight_prop_no_flap, linewidth=2, color='red', alpha=0.5)

plt.semilogy(norm_xpos, no_prop_flap, linestyle='dotted', linewidth=2, color='black')
plt.semilogy(norm_xpos, two_prop_flap, linewidth=2, color='teal', alpha=0.5)
plt.semilogy(norm_xpos, four_prop_flap, linewidth=2, color='orange', alpha=0.5)
plt.semilogy(norm_xpos, six_prop_flap, linewidth=2, color='olive', alpha=0.5)
plt.semilogy(norm_xpos, eight_prop_flap, linewidth=2, color='green', alpha=0.5)

x_p = np.linspace(0,1,num_span)
plt.fill_between(x_p, 0, no_prop_no_flap, alpha=0.5, color='bisque', zorder=-5, label = '_nolegend_')
plt.fill_between(x_p, 0, no_prop_flap, alpha=0.5, color='aliceblue', zorder=-10, label = '_nolegend_')

# plt.scatter(norm_xpos, data/n_avg, label='_nolegend_')
for i in range(int(num_props/2)): plt.axvline(x=rpos[i], color='gray', linestyle='dashdot', linewidth=1)
plt.xlim([0,1])

plt.xlabel('Spanwise location')
plt.ylabel('Lift (N/m)')

plt.yticks([2000,5000,10000,20000], labels=[2000,5000,10000,20000])


plt.legend(['no props no flaps', 'two props no flaps', 'four props no flaps', 'six props no flaps', 'eight props no flaps', 'no props with full-span flaps at 'r'$27^\circ$', 'two props with flaps', 'four props with flaps', 'six props with flaps', 'eight props with flaps', 'prop locations'], fontsize=8, frameon=True)

plt.scatter(norm_xpos, no_prop_no_flap, s=30, color='violet', alpha=1, zorder=-1)
plt.scatter(norm_xpos, no_prop_flap, s=30, color='violet', alpha=1, zorder=-1)


plt.title('Spanwise lift at ' r'$\theta=0^\circ$' ', Mach 0.15, with/without full-span flaps (ns=61, nc=14)')

plt.savefig('dist.png', transparent=True, bbox_inches="tight", dpi=500)
plt.show()